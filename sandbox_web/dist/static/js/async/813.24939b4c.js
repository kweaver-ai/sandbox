"use strict";(self.webpackChunksandbox_web=self.webpackChunksandbox_web||[]).push([["813"],{4608(e,t,o){o.d(t,{JR:()=>s,Sn:()=>i,nS:()=>r});let s="http://localhost:8000",i={HEALTH:"/api/v1/health",HEALTH_DETAILED:"/api/v1/health/detailed",TEMPLATES:"/api/v1/templates",TEMPLATE:e=>`/api/v1/templates/${e}`,SESSIONS:"/api/v1/sessions",SESSION:e=>`/api/v1/sessions/${e}`,EXECUTE:e=>`/api/v1/executions/sessions/${e}/execute`,EXECUTION_STATUS:e=>`/api/v1/executions/${e}/status`,EXECUTION_RESULT:e=>`/api/v1/executions/${e}/result`,EXECUTIONS_BY_SESSION:e=>`/api/v1/executions/sessions/${e}/executions`,UPLOAD_FILE:e=>`/api/v1/sessions/${e}/files/upload`,DOWNLOAD_FILE:(e,t)=>`/api/v1/sessions/${e}/files/${t}`},r={LIMIT:50,OFFSET:0}},4372(e,t,o){o.d(t,{Gw:()=>i,iZ:()=>s,iu:()=>n,mx:()=>r});let s={"python3.11":"Python 3.11",nodejs20:"Node.js 20",java17:"Java 17","go1.21":"Go 1.21"},i={PENDING:"等待中",STARTING:"启动中",RUNNING:"运行中",COMPLETED:"已完成",FAILED:"失败",TIMEOUT:"超时"},r={PENDING:"等待中",RUNNING:"执行中",COMPLETED:"成功",FAILED:"失败",TIMEOUT:"超时",CRASHED:"崩溃"},n={CPU:["0.5","1","2","4"],MEMORY:["128Mi","256Mi","512Mi","1Gi","2Gi","4Gi","8Gi"],DISK:["256Mi","512Mi","1Gi","5Gi","10Gi","20Gi","50Gi"]}},644(e,t,o){o.r(t),o.d(t,{default:()=>E});var s=o(4848),i=o(6540),r=o(6040),n=o(697),l=o(5303),a=o(5196),d=o(3860),c=o(1579),u=o(4518),m=o(7959),f=o(4608),g=o(1643),p=o(4372);let h=[{id:"session-001",name:"session-001 (python3.11)",status:"RUNNING"},{id:"session-002",name:"session-002 (python3.11)",status:"COMPLETED"},{id:"session-003",name:"session-003 (nodejs20)",status:"RUNNING"}],x=`def handler(event):
    name = event.get("name", "World")
    return {"message": f"Hello, {name}!"}
`,y=`{
  "name": "Sandbox Platform"
}`;function E(){let[e,t]=(0,i.useState)("session-001"),[o,a]=(0,i.useState)(x),[c,E]=(0,i.useState)(y),[b,j]=(0,i.useState)(""),{executions:v,currentExecution:N,loading:T,executeCode:I}=function(){let[e,t]=(0,i.useState)([]),[o,s]=(0,i.useState)(!1),[r,n]=(0,i.useState)(null),l=(0,i.useCallback)(async(e,t)=>{s(!0);try{let o=await (0,g.bE)(f.Sn.EXECUTE(e),t);return a(o.execution_id),o}catch(e){throw m.Ay.error("代码执行提交失败"),console.error(e),e}finally{s(!1)}},[]),a=(0,i.useCallback)(async e=>{let o=0,s=async()=>{o++;try{let i=await (0,g.Jt)(f.Sn.EXECUTION_RESULT(e));n(i),"PENDING"===i.status||"RUNNING"===i.status?o<60&&setTimeout(s,1e3):(t(e=>[i,...e]),"COMPLETED"===i.status?m.Ay.success("代码执行成功"):m.Ay.error("代码执行失败"))}catch(e){console.error("获取执行结果失败",e),o<60&&setTimeout(s,1e3)}};s()},[]);return{executions:e,currentExecution:r,loading:o,executeCode:l,fetchSessionExecutions:(0,i.useCallback)(async e=>{s(!0);try{let o=await (0,g.Jt)(f.Sn.EXECUTIONS_BY_SESSION(e),{params:{...f.nS,...void 0}});t(o.items)}catch(e){m.Ay.error("获取执行历史失败"),console.error(e)}finally{s(!1)}},[]),clearCurrentExecution:(0,i.useCallback)(()=>{n(null)},[])}}(),C=async()=>{try{JSON.parse(c),j("")}catch{j("Event 数据必须是有效的 JSON 格式");return}let t={code:o,language:"python",event:JSON.parse(c),timeout:30};await I(e,t)},A=e=>{let t={PENDING:{color:"warning",icon:"⏱",label:p.mx.PENDING},RUNNING:{color:"processing",icon:"⚡",label:p.mx.RUNNING},COMPLETED:{color:"success",icon:"✓",label:p.mx.COMPLETED},FAILED:{color:"error",icon:"✗",label:p.mx.FAILED},TIMEOUT:{color:"error",icon:"⏱",label:p.mx.TIMEOUT},CRASHED:{color:"error",icon:"\uD83D\uDCA5",label:p.mx.CRASHED}};return t[e]||t.PENDING};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{style:{marginBottom:24},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:8},children:[(0,s.jsx)("div",{style:{width:2,height:18,backgroundColor:"#126ee3",borderRadius:4,marginRight:8}}),(0,s.jsx)("h2",{style:{fontSize:15,fontWeight:500,margin:0,color:"#000000"},children:"代码执行"})]}),(0,s.jsx)("p",{style:{fontSize:13,color:"#677489",marginLeft:12,marginTop:0,marginBottom:0},children:"在选定的会话中执行 Python 代码"})]}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:24},children:[(0,s.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:16},children:(0,s.jsxs)("div",{style:{backgroundColor:"#ffffff",borderRadius:12,border:"1px solid #e7edf7",padding:24},children:[(0,s.jsxs)("div",{style:{marginBottom:16},children:[(0,s.jsx)("label",{style:{display:"block",fontSize:14,color:"rgba(0,0,0,0.85)",marginBottom:8},children:"选择会话"}),(0,s.jsx)(r.A,{value:e,onChange:t,style:{width:"100%"},children:h.map(e=>(0,s.jsxs)(r.A.Option,{value:e.id,children:[e.name," - ",e.status]},e.id))})]}),(0,s.jsxs)("div",{style:{marginBottom:16},children:[(0,s.jsx)("label",{style:{display:"block",fontSize:14,color:"rgba(0,0,0,0.85)",marginBottom:8},children:"Python 代码 (Lambda Handler 格式)"}),(0,s.jsx)("div",{style:{border:"1px solid #d9d9d9",borderRadius:4,overflow:"hidden"},children:(0,s.jsx)(u.Ay,{height:280,defaultLanguage:"python",value:o,onChange:e=>a(e||""),theme:"vs-light",options:{minimap:{enabled:!1},fontSize:13,lineNumbers:"on",scrollBeyondLastLine:!1,automaticLayout:!0}})})]}),(0,s.jsxs)("div",{style:{marginBottom:16},children:[(0,s.jsx)("label",{style:{display:"block",fontSize:14,color:"rgba(0,0,0,0.85)",marginBottom:8},children:"Event 数据 (JSON)"}),(0,s.jsx)("div",{style:{border:"1px solid #d9d9d9",borderRadius:4,overflow:"hidden"},children:(0,s.jsx)(u.Ay,{height:120,defaultLanguage:"json",value:c,onChange:e=>E(e||""),theme:"vs-light",options:{minimap:{enabled:!1},fontSize:13,lineNumbers:"on",scrollBeyondLastLine:!1,automaticLayout:!0}})}),b&&(0,s.jsx)("div",{style:{color:"#ff4d4f",fontSize:12,marginTop:4},children:b})]}),(0,s.jsx)(n.Ay,{type:"primary",icon:(0,s.jsx)(d.A,{}),onClick:C,disabled:T,size:"large",style:{width:"100%"},children:T?"执行中...":"执行代码"})]})}),(0,s.jsxs)("div",{style:{backgroundColor:"#ffffff",borderRadius:12,border:"1px solid #e7edf7",padding:24},children:[(0,s.jsx)("h3",{style:{fontSize:15,fontWeight:500,marginTop:0,marginBottom:16,color:"#000000"},children:"执行历史"}),(0,s.jsx)("div",{style:{maxHeight:600,overflowY:"auto"},children:0!==v.length||N?(0,s.jsxs)(s.Fragment,{children:[N&&(0,s.jsx)(S,{execution:N,getStatusConfig:A}),v.map(e=>(0,s.jsx)(S,{execution:e,getStatusConfig:A},e.id))]}):(0,s.jsx)(l.A,{image:l.A.PRESENTED_IMAGE_SIMPLE,description:"暂无执行记录",style:{padding:"40px 0"}})})]})]})]})}function S(e){let{execution:t,getStatusConfig:o}=e,[r,n]=(0,i.useState)(!1),l=o(t.status);return(0,s.jsxs)("div",{style:{border:"1px solid #e7edf7",borderRadius:8,padding:16,marginBottom:12,transition:"border-color 0.2s"},children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12},children:[(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[(0,s.jsx)("span",{style:{fontSize:13,fontWeight:500,color:"rgba(0,0,0,0.85)"},children:t.id}),(0,s.jsxs)(a.A,{color:l.color,children:[l.icon," ",l.label]})]}),(0,s.jsx)("p",{style:{fontSize:12,color:"#677489",margin:0},children:t.created_at})]}),t.execution_time&&(0,s.jsxs)("div",{style:{textAlign:"right"},children:[(0,s.jsx)("p",{style:{fontSize:12,color:"#677489",margin:0},children:"耗时"}),(0,s.jsxs)("p",{style:{fontSize:13,fontWeight:500,color:"rgba(0,0,0,0.85)",margin:0},children:[(1e3*t.execution_time).toFixed(0),"ms"]})]})]}),"COMPLETED"===t.status&&t.return_value&&(0,s.jsxs)("div",{style:{marginBottom:8},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4,marginBottom:4},children:[(0,s.jsx)(c.A,{style:{fontSize:12,color:"#52c41a"}}),(0,s.jsx)("p",{style:{fontSize:12,fontWeight:500,color:"rgba(0,0,0,0.85)",margin:0},children:"返回值"})]}),(0,s.jsx)("pre",{style:{backgroundColor:"#f6ffed",border:"1px solid #b7eb8f",borderRadius:4,padding:8,fontSize:11,fontFamily:"monospace",overflow:"auto",margin:0},children:JSON.stringify(t.return_value,null,2)})]}),t.stdout&&(0,s.jsxs)("div",{style:{marginBottom:8},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4,marginBottom:4},children:[(0,s.jsx)(c.A,{style:{fontSize:12,color:"#1890ff"}}),(0,s.jsx)("p",{style:{fontSize:12,fontWeight:500,color:"rgba(0,0,0,0.85)",margin:0},children:"标准输出"})]}),(0,s.jsx)("pre",{style:{backgroundColor:"#fafafa",border:"1px solid #e7edf7",borderRadius:4,padding:8,fontSize:11,fontFamily:"monospace",overflow:"auto",margin:0},children:t.stdout})]}),t.stderr&&(0,s.jsxs)("div",{style:{marginBottom:8},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4,marginBottom:4},children:[(0,s.jsx)(c.A,{style:{fontSize:12,color:"#ff4d4f"}}),(0,s.jsx)("p",{style:{fontSize:12,fontWeight:500,color:"rgba(0,0,0,0.85)",margin:0},children:"错误信息"})]}),(0,s.jsx)("pre",{style:{backgroundColor:"#fff1f0",border:"1px solid #ffccc7",borderRadius:4,padding:8,fontSize:11,fontFamily:"monospace",overflow:"auto",color:"#ff4d4f",margin:0},children:t.stderr})]}),(0,s.jsxs)("details",{style:{marginTop:8},children:[(0,s.jsx)("summary",{style:{fontSize:12,color:"#126ee3",cursor:"pointer",userSelect:"none"},children:"查看代码"}),(0,s.jsx)("pre",{style:{marginTop:8,backgroundColor:"#fafafa",border:"1px solid #e7edf7",borderRadius:4,padding:8,fontSize:11,fontFamily:"monospace",overflow:"auto",margin:0},children:t.code})]})]},t.id)}},1643(e,t,o){o.d(t,{Jt:()=>n,bE:()=>l,yJ:()=>a,yH:()=>d});var s=o(8909),i=o(4608);let r=s.A.create({baseURL:i.JR,timeout:3e4,headers:{"Content-Type":"application/json"}});function n(e,t){return r.get(e,t)}function l(e,t,o){return r.post(e,t,o)}function a(e,t,o){return r.put(e,t,o)}function d(e,t){return r.delete(e,t)}r.interceptors.request.use(e=>e,e=>Promise.reject(e)),r.interceptors.response.use(e=>e.data,e=>{if(e.response){let{status:t,data:o}=e.response;console.error(`API Error [${t}]:`,o)}else e.request?console.error("Network Error:",e.message):console.error("Request Error:",e.message);return Promise.reject(e)})}}]);