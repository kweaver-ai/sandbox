"use strict";(self.webpackChunksandbox_web=self.webpackChunksandbox_web||[]).push([["332"],{4608(e,t,r){r.d(t,{JR:()=>s,Sn:()=>i,nS:()=>a});let s="http://localhost:8000",i={HEALTH:"/api/v1/health",HEALTH_DETAILED:"/api/v1/health/detailed",TEMPLATES:"/api/v1/templates",TEMPLATE:e=>`/api/v1/templates/${e}`,SESSIONS:"/api/v1/sessions",SESSION:e=>`/api/v1/sessions/${e}`,EXECUTE:e=>`/api/v1/executions/sessions/${e}/execute`,EXECUTION_STATUS:e=>`/api/v1/executions/${e}/status`,EXECUTION_RESULT:e=>`/api/v1/executions/${e}/result`,EXECUTIONS_BY_SESSION:e=>`/api/v1/executions/sessions/${e}/executions`,UPLOAD_FILE:e=>`/api/v1/sessions/${e}/files/upload`,DOWNLOAD_FILE:(e,t)=>`/api/v1/sessions/${e}/files/${t}`},a={LIMIT:50,OFFSET:0}},4372(e,t,r){r.d(t,{Gw:()=>i,iZ:()=>s,iu:()=>l,mx:()=>a});let s={"python3.11":"Python 3.11",nodejs20:"Node.js 20",java17:"Java 17","go1.21":"Go 1.21"},i={PENDING:"等待中",STARTING:"启动中",RUNNING:"运行中",COMPLETED:"已完成",FAILED:"失败",TIMEOUT:"超时"},a={PENDING:"等待中",RUNNING:"执行中",COMPLETED:"成功",FAILED:"失败",TIMEOUT:"超时",CRASHED:"崩溃"},l={CPU:["0.5","1","2","4"],MEMORY:["128Mi","256Mi","512Mi","1Gi","2Gi","4Gi","8Gi"],DISK:["256Mi","512Mi","1Gi","5Gi","10Gi","20Gi","50Gi"]}},350(e,t,r){r.d(t,{b:()=>n});var s=r(6540),i=r(7959),a=r(4608),l=r(1643);function n(){let[e,t]=(0,s.useState)([]),[r,n]=(0,s.useState)(!1),o=(0,s.useCallback)(async()=>{n(!0);try{let e=await (0,l.Jt)(a.Sn.TEMPLATES,{params:{...a.nS,...void 0}});t(e)}catch(e){i.Ay.error("获取模板列表失败"),console.error(e)}finally{n(!1)}},[]),d=(0,s.useCallback)(async e=>{n(!0);try{let r=await (0,l.bE)(a.Sn.TEMPLATES,e);return t(e=>[...e,r]),i.Ay.success("模板创建成功"),r}catch(e){throw i.Ay.error("模板创建失败"),console.error(e),e}finally{n(!1)}},[]);return{templates:e,loading:r,fetchTemplates:o,createTemplate:d,updateTemplate:(0,s.useCallback)(async(e,r)=>{n(!0);try{let s=await (0,l.yJ)(a.Sn.TEMPLATE(e),r);return t(t=>t.map(t=>t.id===e?s:t)),i.Ay.success("模板更新成功"),s}catch(e){throw i.Ay.error("模板更新失败"),console.error(e),e}finally{n(!1)}},[]),deleteTemplate:(0,s.useCallback)(async e=>{n(!0);try{await (0,l.yH)(a.Sn.TEMPLATE(e)),t(t=>t.filter(t=>t.id!==e)),i.Ay.success("模板删除成功")}catch(e){throw i.Ay.error("模板删除失败"),console.error(e),e}finally{n(!1)}},[])}}},6383(e,t,r){r.r(t),r.d(t,{default:()=>T});var s=r(4848),i=r(6540),a=r(3543),l=r(5196),n=r(3133),o=r(697),d=r(7073),c=r(2402),u=r(3852),m=r(5801),h=r(6040),y=r(9671),p=r(6385),x=r(6029),A=r(4811),E=r(8623),j=r(350),f=r(4372);function T(){let{templates:e,loading:t,fetchTemplates:r,createTemplate:T,deleteTemplate:g}=(0,j.b)(),[I,w]=(0,i.useState)(""),[S,b]=(0,i.useState)(!1),[v]=a.A.useForm();(0,i.useEffect)(()=>{r()},[r]);let C=e.filter(e=>e.name.toLowerCase().includes(I.toLowerCase())||e.id.toLowerCase().includes(I.toLowerCase())),_=async()=>{try{let e=await v.validateFields();await T(e),b(!1),v.resetFields()}catch(e){}},L=async e=>{try{await g(e)}catch(e){}},k=[{title:"模版ID",dataIndex:"id",key:"id",width:200},{title:"模版名称",dataIndex:"name",key:"name",width:200},{title:"运行时",dataIndex:"runtime_type",key:"runtime_type",width:120,render:e=>f.iZ[e]||e},{title:"资源配置",key:"resources",width:200,render:(e,t)=>`${t.default_cpu_cores}核 / ${t.default_memory_mb}MB / ${t.default_disk_mb}MB`},{title:"状态",dataIndex:"is_active",key:"is_active",width:80,render:e=>e?(0,s.jsx)(l.A,{color:"success",children:"活跃"}):(0,s.jsx)(l.A,{color:"error",children:"停用"})},{title:"操作",key:"action",width:120,render:(e,t)=>(0,s.jsxs)(n.A,{size:"small",children:[(0,s.jsx)(o.Ay,{type:"text",icon:(0,s.jsx)(p.A,{}),size:"small",onClick:()=>{}}),(0,s.jsx)(d.A,{title:"确认删除",description:"确定要删除该模版吗？",onConfirm:()=>L(t.id),okText:"确定",cancelText:"取消",children:(0,s.jsx)(o.Ay,{type:"text",danger:!0,icon:(0,s.jsx)(x.A,{}),size:"small"})})]})}];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{style:{marginBottom:24},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:8},children:[(0,s.jsx)("div",{style:{width:2,height:18,backgroundColor:"#126ee3",borderRadius:4,marginRight:8}}),(0,s.jsx)("h2",{style:{fontSize:15,fontWeight:500,margin:0,color:"#000000"},children:"模版管理"})]}),(0,s.jsx)("p",{style:{fontSize:13,color:"#677489",marginLeft:12,marginTop:0,marginBottom:0},children:"创建和管理代码执行环境模版"})]}),(0,s.jsxs)("div",{style:{backgroundColor:"#ffffff",borderRadius:12,border:"1px solid #e7edf7",padding:24},children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:24},children:[(0,s.jsx)(c.A,{placeholder:"搜索模版名称或ID",prefix:(0,s.jsx)(A.A,{}),value:I,onChange:e=>w(e.target.value),style:{width:320},allowClear:!0}),(0,s.jsx)(o.Ay,{type:"primary",icon:(0,s.jsx)(E.A,{}),onClick:()=>b(!0),children:"创建模版"})]}),(0,s.jsx)(u.A,{columns:k,dataSource:C,rowKey:"id",loading:t,pagination:{pageSize:10},style:{overflow:"auto"}})]}),(0,s.jsx)(m.A,{title:"创建新模版",open:S,onOk:_,onCancel:()=>{b(!1),v.resetFields()},width:600,okText:"创建",cancelText:"取消",children:(0,s.jsxs)(a.A,{form:v,layout:"vertical",style:{marginTop:24},children:[(0,s.jsx)(a.A.Item,{name:"id",label:"模版ID",rules:[{required:!0,message:"请输入模版ID"}],children:(0,s.jsx)(c.A,{placeholder:"例如: python-3.11-advanced"})}),(0,s.jsx)(a.A.Item,{name:"name",label:"模版名称",rules:[{required:!0,message:"请输入模版名称"}],children:(0,s.jsx)(c.A,{placeholder:"例如: Python 3.11 高级环境"})}),(0,s.jsx)(a.A.Item,{name:"image_url",label:"镜像 URL",rules:[{required:!0,message:"请输入镜像 URL"}],children:(0,s.jsx)(c.A,{placeholder:"例如: python:3.11-slim"})}),(0,s.jsx)(a.A.Item,{name:"runtime_type",label:"运行时类型",rules:[{required:!0,message:"请选择运行时类型"}],initialValue:"python3.11",children:(0,s.jsx)(h.A,{children:Object.entries(f.iZ).map(e=>{let[t,r]=e;return(0,s.jsx)(h.A.Option,{value:t,children:r},t)})})}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[(0,s.jsx)(a.A.Item,{name:"default_cpu_cores",label:"CPU核心数",rules:[{required:!0,message:"请输入CPU核心数"}],initialValue:1,children:(0,s.jsx)(y.A,{min:.1,max:4,step:.1,style:{width:"100%"}})}),(0,s.jsx)(a.A.Item,{name:"default_memory_mb",label:"内存(MB)",rules:[{required:!0,message:"请输入内存"}],initialValue:512,children:(0,s.jsx)(y.A,{min:128,max:8192,style:{width:"100%"}})}),(0,s.jsx)(a.A.Item,{name:"default_disk_mb",label:"磁盘(MB)",rules:[{required:!0,message:"请输入磁盘"}],initialValue:1024,children:(0,s.jsx)(y.A,{min:256,max:51200,style:{width:"100%"}})}),(0,s.jsx)(a.A.Item,{name:"default_timeout_sec",label:"超时(秒)",rules:[{required:!0,message:"请输入超时时间"}],initialValue:300,children:(0,s.jsx)(y.A,{min:60,max:3600,style:{width:"100%"}})})]})]})})]})}},1643(e,t,r){r.d(t,{Jt:()=>l,bE:()=>n,yJ:()=>o,yH:()=>d});var s=r(8909),i=r(4608);let a=s.A.create({baseURL:i.JR,timeout:3e4,headers:{"Content-Type":"application/json"}});function l(e,t){return a.get(e,t)}function n(e,t,r){return a.post(e,t,r)}function o(e,t,r){return a.put(e,t,r)}function d(e,t){return a.delete(e,t)}a.interceptors.request.use(e=>e,e=>Promise.reject(e)),a.interceptors.response.use(e=>e.data,e=>{if(e.response){let{status:t,data:r}=e.response;console.error(`API Error [${t}]:`,r)}else e.request?console.error("Network Error:",e.message):console.error("Request Error:",e.message);return Promise.reject(e)})}}]);