"use strict";(self.webpackChunksandbox_web=self.webpackChunksandbox_web||[]).push([["332"],{5182(e,t,r){r.d(t,{I7:()=>o,Xu:()=>n,ub:()=>d,$F:()=>i,eG:()=>a});var s=r(4608),l=r(3232);function a(e){return(0,l.Jt)(s.Sn.TEMPLATES,{params:{...s.nS,...e}})}function i(e){return(0,l.Jt)(s.Sn.TEMPLATE(e))}function n(e){return(0,l.bE)(s.Sn.TEMPLATES,e)}function d(e,t){return(0,l.yJ)(s.Sn.TEMPLATE(e),t)}function o(e){return(0,l.yH)(s.Sn.TEMPLATE(e))}},4608(e,t,r){r.d(t,{JR:()=>s,Sn:()=>l,nS:()=>a});let s="http://localhost:8000",l={HEALTH:"/api/v1/health",HEALTH_DETAILED:"/api/v1/health/detailed",TEMPLATES:"/api/v1/templates",TEMPLATE:e=>`/api/v1/templates/${e}`,SESSIONS:"/api/v1/sessions",SESSION:e=>`/api/v1/sessions/${e}`,EXECUTE:e=>`/api/v1/executions/sessions/${e}/execute`,EXECUTION_STATUS:e=>`/api/v1/executions/${e}/status`,EXECUTION_RESULT:e=>`/api/v1/executions/${e}/result`,EXECUTIONS_BY_SESSION:e=>`/api/v1/executions/sessions/${e}/executions`,UPLOAD_FILE:e=>`/api/v1/sessions/${e}/files/upload`,DOWNLOAD_FILE:(e,t)=>`/api/v1/sessions/${e}/files/${t}`},a={LIMIT:50,OFFSET:0}},4372(e,t,r){r.d(t,{Gw:()=>l,iZ:()=>s,iu:()=>i,mx:()=>a});let s={"python3.11":"Python 3.11",nodejs20:"Node.js 20",java17:"Java 17","go1.21":"Go 1.21"},l={PENDING:"等待中",CREATING:"创建中",STARTING:"启动中",RUNNING:"运行中",COMPLETED:"已完成",TERMINATED:"已终止",FAILED:"失败",TIMEOUT:"超时"},a={PENDING:"等待中",RUNNING:"执行中",COMPLETED:"成功",FAILED:"失败",TIMEOUT:"超时",CRASHED:"崩溃"},i={CPU:["0.5","1","2","4"],MEMORY:["128Mi","256Mi","512Mi","1Gi","2Gi","4Gi","8Gi"],DISK:["256Mi","512Mi","1Gi","5Gi","10Gi","20Gi","50Gi"]}},711(e,t,r){r.d(t,{b:()=>i});var s=r(6540),l=r(7959),a=r(5182);function i(){let[e,t]=(0,s.useState)([]),[r,i]=(0,s.useState)(!1),n=(0,s.useCallback)(async()=>{i(!0);try{let e=await a.eG();t(e)}catch(e){l.Ay.error("获取模板列表失败"),console.error(e)}finally{i(!1)}},[]),d=(0,s.useCallback)(async e=>{i(!0);try{let r=await a.Xu(e);return t(e=>[...e,r]),l.Ay.success("模板创建成功"),r}catch(e){throw l.Ay.error("模板创建失败"),console.error(e),e}finally{i(!1)}},[]);return{templates:e,loading:r,fetchTemplates:n,createTemplate:d,updateTemplate:(0,s.useCallback)(async(e,r)=>{i(!0);try{let s=await a.ub(e,r);return t(t=>t.map(t=>t.id===e?s:t)),l.Ay.success("模板更新成功"),s}catch(e){throw l.Ay.error("模板更新失败"),console.error(e),e}finally{i(!1)}},[]),deleteTemplate:(0,s.useCallback)(async e=>{i(!0);try{await a.I7(e),t(t=>t.filter(t=>t.id!==e)),l.Ay.success("模板删除成功")}catch(e){throw l.Ay.error("模板删除失败"),console.error(e),e}finally{i(!1)}},[])}}},6383(e,t,r){r.r(t),r.d(t,{default:()=>g});var s=r(4848),l=r(6540),a=r(3543),i=r(5196),n=r(3133),d=r(697),o=r(7073),c=r(5658),u=r(3852),m=r(5801),h=r(2880),x=r(9671),A=r(6223),y=r(7532),p=r(6385),j=r(6029),f=r(4811),_=r(8623),b=r(711),I=r(4372),E=r(5182);function g(){let{templates:e,loading:t,fetchTemplates:r,createTemplate:g,deleteTemplate:T}=(0,b.b)(),[w,v]=(0,l.useState)(""),[C,S]=(0,l.useState)(!1),[k,L]=(0,l.useState)(!1),[M,P]=(0,l.useState)(!1),[U,N]=(0,l.useState)(null),[R]=a.A.useForm(),[D]=a.A.useForm();(0,l.useEffect)(()=>{r()},[r]);let F=e.filter(e=>e.name.toLowerCase().includes(w.toLowerCase())||e.id.toLowerCase().includes(w.toLowerCase())),G=async()=>{try{let e=await R.validateFields();await g(e),S(!1),R.resetFields()}catch(e){}},O=async e=>{try{let t=await E.$F(e.id);N(t),L(!0)}catch(e){}},q=async e=>{try{let t=await E.$F(e.id);N(t),D.setFieldsValue({name:t.name,image_url:t.image_url,default_cpu_cores:t.default_cpu_cores,default_memory_mb:t.default_memory_mb,default_disk_mb:t.default_disk_mb,default_timeout:t.default_timeout_sec,default_env_vars:t.default_env_vars}),P(!0)}catch(e){}},$=async()=>{if(U)try{let e=await D.validateFields();await E.ub(U.id,e),P(!1),D.resetFields(),N(null),r()}catch(e){}},B=async e=>{try{await T(e)}catch(e){}},z=[{title:"模版ID",dataIndex:"id",key:"id",width:200},{title:"模版名称",dataIndex:"name",key:"name",width:200},{title:"运行时",dataIndex:"runtime_type",key:"runtime_type",width:120,render:e=>I.iZ[e]||e},{title:"资源配置",key:"resources",width:200,render:(e,t)=>`${t.default_cpu_cores}核 / ${t.default_memory_mb}MB / ${t.default_disk_mb}MB`},{title:"状态",dataIndex:"is_active",key:"is_active",width:80,render:e=>e?(0,s.jsx)(i.A,{color:"success",children:"活跃"}):(0,s.jsx)(i.A,{color:"error",children:"停用"})},{title:"操作",key:"action",width:180,render:(e,t)=>(0,s.jsxs)(n.A,{size:"small",children:[(0,s.jsx)(d.Ay,{type:"text",icon:(0,s.jsx)(y.A,{}),size:"small",title:"查看详情",onClick:()=>O(t)}),(0,s.jsx)(d.Ay,{type:"text",icon:(0,s.jsx)(p.A,{}),size:"small",title:"编辑",onClick:()=>q(t)}),(0,s.jsx)(o.A,{title:"确认删除",description:"确定要删除该模版吗？",onConfirm:()=>B(t.id),okText:"确定",cancelText:"取消",children:(0,s.jsx)(d.Ay,{type:"text",danger:!0,icon:(0,s.jsx)(j.A,{}),size:"small"})})]})}];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{style:{marginBottom:24},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:8},children:[(0,s.jsx)("div",{style:{width:2,height:18,backgroundColor:"#126ee3",borderRadius:4,marginRight:8}}),(0,s.jsx)("h2",{style:{fontSize:15,fontWeight:500,margin:0,color:"#000000"},children:"模版管理"})]}),(0,s.jsx)("p",{style:{fontSize:13,color:"#677489",marginLeft:12,marginTop:0,marginBottom:0},children:"创建和管理代码执行环境模版"})]}),(0,s.jsxs)("div",{style:{backgroundColor:"#ffffff",borderRadius:12,border:"1px solid #e7edf7",padding:24},children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:24},children:[(0,s.jsx)(c.A,{placeholder:"搜索模版名称或ID",prefix:(0,s.jsx)(f.A,{}),value:w,onChange:e=>v(e.target.value),style:{width:320},allowClear:!0}),(0,s.jsx)(d.Ay,{type:"primary",icon:(0,s.jsx)(_.A,{}),onClick:()=>S(!0),children:"创建模版"})]}),(0,s.jsx)(u.A,{columns:z,dataSource:F,rowKey:"id",loading:t,pagination:{pageSize:10},style:{overflow:"auto"}})]}),(0,s.jsx)(m.A,{title:"创建新模版",open:C,onOk:G,onCancel:()=>{S(!1),R.resetFields()},width:600,okText:"创建",cancelText:"取消",children:(0,s.jsxs)(a.A,{form:R,layout:"vertical",style:{marginTop:24},children:[(0,s.jsx)(a.A.Item,{name:"id",label:"模版ID",rules:[{required:!0,message:"请输入模版ID"}],children:(0,s.jsx)(c.A,{placeholder:"例如: python-3.11-advanced"})}),(0,s.jsx)(a.A.Item,{name:"name",label:"模版名称",rules:[{required:!0,message:"请输入模版名称"}],children:(0,s.jsx)(c.A,{placeholder:"例如: Python 3.11 高级环境"})}),(0,s.jsx)(a.A.Item,{name:"image_url",label:"镜像 URL",rules:[{required:!0,message:"请输入镜像 URL"}],children:(0,s.jsx)(c.A,{placeholder:"例如: python:3.11-slim"})}),(0,s.jsx)(a.A.Item,{name:"runtime_type",label:"运行时类型",rules:[{required:!0,message:"请选择运行时类型"}],initialValue:"python3.11",children:(0,s.jsx)(h.A,{children:Object.entries(I.iZ).map(e=>{let[t,r]=e;return(0,s.jsx)(h.A.Option,{value:t,children:r},t)})})}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[(0,s.jsx)(a.A.Item,{name:"default_cpu_cores",label:"CPU核心数",rules:[{required:!0,message:"请输入CPU核心数"}],initialValue:1,children:(0,s.jsx)(x.A,{min:.1,max:4,step:.1,style:{width:"100%"}})}),(0,s.jsx)(a.A.Item,{name:"default_memory_mb",label:"内存(MB)",rules:[{required:!0,message:"请输入内存"}],initialValue:512,children:(0,s.jsx)(x.A,{min:128,max:8192,style:{width:"100%"}})}),(0,s.jsx)(a.A.Item,{name:"default_disk_mb",label:"磁盘(MB)",rules:[{required:!0,message:"请输入磁盘"}],initialValue:1024,children:(0,s.jsx)(x.A,{min:256,max:51200,style:{width:"100%"}})}),(0,s.jsx)(a.A.Item,{name:"default_timeout_sec",label:"超时(秒)",rules:[{required:!0,message:"请输入超时时间"}],initialValue:300,children:(0,s.jsx)(x.A,{min:60,max:3600,style:{width:"100%"}})})]})]})}),(0,s.jsx)(m.A,{title:"模板详情",open:k,onCancel:()=>{L(!1),N(null)},footer:[(0,s.jsx)(d.Ay,{onClick:()=>L(!1),children:"关闭"},"close")],width:700,children:U&&(0,s.jsxs)(A.A,{bordered:!0,column:2,size:"small",children:[(0,s.jsx)(A.A.Item,{label:"模板ID",span:2,children:(0,s.jsx)("code",{children:U.id})}),(0,s.jsx)(A.A.Item,{label:"模板名称",span:2,children:U.name}),(0,s.jsx)(A.A.Item,{label:"镜像 URL",span:2,children:(0,s.jsx)("code",{children:U.image_url})}),(0,s.jsx)(A.A.Item,{label:"运行时类型",children:I.iZ[U.runtime_type]||U.runtime_type}),(0,s.jsx)(A.A.Item,{label:"状态",children:U.is_active?(0,s.jsx)(i.A,{color:"success",children:"活跃"}):(0,s.jsx)(i.A,{color:"error",children:"停用"})}),(0,s.jsx)(A.A.Item,{label:"CPU核心数",children:U.default_cpu_cores}),(0,s.jsx)(A.A.Item,{label:"内存(MB)",children:U.default_memory_mb}),(0,s.jsx)(A.A.Item,{label:"磁盘(MB)",children:U.default_disk_mb}),(0,s.jsx)(A.A.Item,{label:"超时(秒)",children:U.default_timeout_sec}),U.created_at&&(0,s.jsx)(A.A.Item,{label:"创建时间",span:2,children:U.created_at}),U.updated_at&&(0,s.jsx)(A.A.Item,{label:"更新时间",span:2,children:U.updated_at})]})}),(0,s.jsx)(m.A,{title:"编辑模板",open:M,onOk:$,onCancel:()=>{P(!1),D.resetFields(),N(null)},width:600,okText:"保存",cancelText:"取消",children:(0,s.jsxs)(a.A,{form:D,layout:"vertical",style:{marginTop:24},children:[(0,s.jsx)(a.A.Item,{name:"name",label:"模版名称",rules:[{required:!0,message:"请输入模版名称"}],children:(0,s.jsx)(c.A,{placeholder:"例如: Python 3.11 高级环境"})}),(0,s.jsx)(a.A.Item,{name:"image_url",label:"镜像 URL",rules:[{required:!0,message:"请输入镜像 URL"}],children:(0,s.jsx)(c.A,{placeholder:"例如: python:3.11-slim"})}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[(0,s.jsx)(a.A.Item,{name:"default_cpu_cores",label:"CPU核心数",rules:[{required:!0,message:"请输入CPU核心数"}],children:(0,s.jsx)(x.A,{min:.1,max:4,step:.1,style:{width:"100%"}})}),(0,s.jsx)(a.A.Item,{name:"default_memory_mb",label:"内存(MB)",rules:[{required:!0,message:"请输入内存"}],children:(0,s.jsx)(x.A,{min:128,max:8192,style:{width:"100%"}})}),(0,s.jsx)(a.A.Item,{name:"default_disk_mb",label:"磁盘(MB)",rules:[{required:!0,message:"请输入磁盘"}],children:(0,s.jsx)(x.A,{min:256,max:51200,style:{width:"100%"}})}),(0,s.jsx)(a.A.Item,{name:"default_timeout",label:"超时(秒)",rules:[{required:!0,message:"请输入超时时间"}],children:(0,s.jsx)(x.A,{min:60,max:3600,style:{width:"100%"}})})]})]})})]})}},8371(e,t,r){r.d(t,{A:()=>i});var s=r(8909),l=r(4608);let a=s.A.create({baseURL:l.JR,timeout:3e4,headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>e,e=>Promise.reject(e)),a.interceptors.response.use(e=>e.data,e=>{if(e.response){let{status:t,data:r}=e.response;console.error(`API Error [${t}]:`,r)}else e.request?console.error("Network Error:",e.message):console.error("Request Error:",e.message);return Promise.reject(e)});let i=a},3232(e,t,r){r.d(t,{Jt:()=>l,bE:()=>a,yH:()=>n,yJ:()=>i});var s=r(8371);function l(e,t){return s.A.get(e,t)}function a(e,t,r){return s.A.post(e,t,r)}function i(e,t,r){return s.A.put(e,t,r)}function n(e,t){return s.A.delete(e,t)}}}]);