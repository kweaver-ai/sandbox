# Default values for sandbox-platform Helm chart

global:
  namespace: sandbox-system
  runtimeNamespace: sandbox-runtime
  imageRegistry: ""
  imagePullPolicy: IfNotPresent

# Control Plane configuration
controlPlane:
  enabled: true
  replicaCount: 1

  image:
    registry: ""
    repository: sandbox-control-plane
    tag: "latest"
    pullPolicy: IfNotPresent

  service:
    type: ClusterIP
    port: 8000
    annotations: {}

  ingress:
    enabled: false
    className: "nginx"
    annotations: {}
    hosts:
      - host: sandbox-control-plane.example.com
        paths:
          - path: /
            pathType: Prefix
    tls: []

  # Resource limits and requests
  resources:
    requests:
      cpu: 200m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi

  # Node selector
  nodeSelector: {}

  # Tolerations
  tolerations: []

  # Affinity
  affinity:
    podAntiAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
        - weight: 100
          podAffinityTerm:
            labelSelector:
              matchExpressions:
                - key: app
                  operator: In
                  values:
                    - sandbox-control-plane
            topologyKey: kubernetes.io/hostname

  env:
    ENVIRONMENT: "staging"
    DEBUG: "false"
    DATABASE_URL: "mysql+aiomysql://root:password@mariadb.sandbox-system.svc.cluster.local:3306/sandbox"
    KUBERNETES_NAMESPACE: "sandbox-runtime"
    DEFAULT_TIMEOUT: "300"
    MAX_TIMEOUT: "3600"
    DEFAULT_CPU: "1"
    DEFAULT_MEMORY: "512Mi"
    DEFAULT_DISK: "1Gi"
    IDLE_THRESHOLD_MINUTES: "30"
    MAX_LIFETIME_HOURS: "6"
    CLEANUP_INTERVAL_SECONDS: "300"
    DISABLE_BWRAP: "true"
    PYTHONUNBUFFERED: "1"

  s3:
    endpointUrl: "http://minio.sandbox-system.svc.cluster.local:9000"
    bucket: "sandbox-workspace"
    region: "us-east-1"

# Web Console configuration
web:
  enabled: true
  replicaCount: 1

  image:
    registry: ""
    repository: sandbox-web
    tag: "latest"
    pullPolicy: IfNotPresent

  service:
    type: ClusterIP
    port: 80
    annotations: {}

  ingress:
    enabled: false
    className: "nginx"
    annotations: {}
    hosts:
      - host: sandbox-web.example.com
        paths:
          - path: /
            pathType: Prefix
    tls: []

  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 256Mi

  nodeSelector: {}
  tolerations: []
  affinity: {}

# MariaDB configuration
mariadb:
  enabled: true
  replicaCount: 1

  image:
    registry: ""
    repository: mariadb
    tag: "11.2"
    pullPolicy: IfNotPresent

  service:
    type: ClusterIP
    port: 3306

  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi

  # Persistence
  persistence:
    enabled: true
    storageClass: ""
    accessMode: ReadWriteOnce
    size: 10Gi

  auth:
    rootPassword: "password"
    database: "sandbox"
    username: ""
    password: ""

  nodeSelector: {}
  tolerations: []

# MinIO configuration
minio:
  enabled: true
  replicaCount: 1

  image:
    registry: ""
    repository: quay.io/minio/minio
    tag: "latest"
    pullPolicy: IfNotPresent

  service:
    type: ClusterIP
    apiPort: 9000
    consolePort: 9001
    annotations: {}

  ingress:
    enabled: false
    className: "nginx"
    annotations: {}
    hosts:
      - host: minio.example.com
        paths:
          - path: /
            pathType: Prefix
    tls: []

  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi

  persistence:
    enabled: true
    storageClass: ""
    accessMode: ReadWriteOnce
    size: 10Gi

  defaultBuckets:
    - sandbox-workspace

  auth:
    rootUser: "minioadmin"
    rootPassword: "minioadmin"

  nodeSelector: {}
  tolerations: []

# ServiceAccount configuration
serviceAccount:
  create: true
  name: "sandbox-control-plane"
  annotations: {}

# RBAC configuration
rbac:
  create: true
  name: "sandbox-control-plane"

# ConfigMap configuration
configMap:
  create: true
  name: "sandbox-config"

secret:
  create: true
  name: "sandbox-secrets"
  s3:
    accessKeyId: "minioadmin"
    secretAccessKey: "minioadmin"
    region: "us-east-1"

# Runtime namespace configuration
runtimeNamespace:
  create: true
  name: "sandbox-runtime"

# Pod security context
podSecurityContext:
  runAsNonRoot: true
  runAsUser: 1000
  runAsGroup: 1000
  fsGroup: 1000

# Container security context
securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL
  readOnlyRootFilesystem: false
